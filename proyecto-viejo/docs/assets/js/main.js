"use strict";const searchBtn=document.querySelector(".js-button");let seriesInput=document.querySelector(".js-input");const seriesList=document.querySelector(".js-series-container"),seriesListFav=document.querySelector(".js-fav-series-container");let series=[],favoritesSeries=[];function setLocalStorage(){localStorage.setItem("favoritesSeries",JSON.stringify(favoritesSeries))}function getLocalStorage(){const e=JSON.parse(localStorage.getItem("favoritesSeries"));console.log("comprobando",e),null!==e?(console.log("tengo datos"),favoritesSeries=e):console.log("no tengo datos"),paintFavoritesSeries(),listenSeries()}function getServerData(){fetch(`http://api.tvmaze.com/search/shows?q=${seriesInput.value}`).then(function(e){return e.json()}).then(function(e){series=e,paintSeries(),listenSeries(),paintFavoritesSeries()}).catch(function(e){console.error("Error al traer los datos del servidor",e)})}function paintSeries(){let e="";for(let s=0;s<series.length;s++){const i=-1!==favoritesSeries.findIndex(function(e,i){return e.id===series[s].show.id});console.log("fav",favoritesSeries,"actual id",s),e+=!0===i?`<li class="js-serie-element serie__element--fav" id="${series[s].show.id}">`:`<li class="js-serie-element serie__element" id="${series[s].show.id}">`,null!==series[s].show.image?e+=`<img src="${series[s].show.image.medium}" class="js-serie-image serie__image"/>`:e+='<img src="https://via.placeholder.com/210x295/ffffff/666666/?\n        text=TV." class="js-serie-image serie__image"/>',e+=`<h3 class="js-serie-title serie__title">${series[s].show.name}</h3>`,e+="</li>"}seriesList.innerHTML=e}function toggleFavorites(e){const s=parseInt(e.currentTarget.id),i=favoritesSeries.findIndex(function(e,i){return e.id===s}),t=-1!==i;if(!0===t)favoritesSeries.splice(i,1);else for(let e=0;e<series.length;e++)series[e].show.id===s&&favoritesSeries.push(series[e].show);console.log(e.currentTarget.id,favoritesSeries),console.log(i),console.log(t),paintSeries(),listenSeries(),paintFavoritesSeries(),setLocalStorage(),listenDelete()}function listenSeries(){const e=document.querySelectorAll(".js-serie-element");for(const s of e)s.addEventListener("click",toggleFavorites)}function listenDelete(){const e=document.querySelectorAll(".js-delete");for(const s of e)s.addEventListener("click",toggleFavorites);console.log("me oyo")}function paintFavoritesSeries(){let e="";e+="<li><h3>Mis series favoritas:</h3></li>";for(const s of favoritesSeries)e+=`<li class="serie__element" id="${s.id}">`,e+=`<img src="${s.image.medium}" class="js-serie-image serie__image"/>`,e+=`<h3 class="js-serie-title serie__title">${s.name} <span class="js-delete delete-button" id="${s.id}">x</span></h3>`,e+="</li>";seriesListFav.innerHTML=e,listenDelete()}function handleFormSubmit(e){e.preventDefault(),getServerData(),getLocalStorage(),paintSeries(),toggleFavorites(e),listenSeries(),paintFavoritesSeries()}getServerData(),searchBtn.addEventListener("click",handleFormSubmit),getLocalStorage();