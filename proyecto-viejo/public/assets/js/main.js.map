{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["\"use strict\";\n\nconst searchBtn = document.querySelector(\".js-button\");\nlet seriesInput = document.querySelector(\".js-input\");\nconst seriesList = document.querySelector(\".js-series-container\");\nconst seriesListFav = document.querySelector(\".js-fav-series-container\");\n\nlet series = [];\nlet favoritesSeries = [];\n\n///LOCAL STORAGE\\\\\\\n\nfunction setLocalStorage() {\n  //guardado en local storage\n  localStorage.setItem(\"favoritesSeries\", JSON.stringify(favoritesSeries));\n}\nfunction getLocalStorage() {\n  const localStorageFavoritesSeries = JSON.parse(localStorage.getItem(\"favoritesSeries\"));\n  console.log(\"comprobando\", localStorageFavoritesSeries);\n  if (localStorageFavoritesSeries !== null) {\n    console.log(\"tengo datos\");\n    favoritesSeries = localStorageFavoritesSeries;\n  } else {\n    console.log(\"no tengo datos\");\n  }\n  paintFavoritesSeries();\n  listenSeries();\n}\n\nfunction getServerData() {\n  fetch(`http://api.tvmaze.com/search/shows?q=${seriesInput.value}`)\n    .then(function(response) {\n      return response.json();\n    })\n    .then(function(serverData) {\n      series = serverData;\n      paintSeries();\n      listenSeries();\n      paintFavoritesSeries();\n    })\n    .catch(function(err) {\n      console.error(\"Error al traer los datos del servidor\", err);\n    });\n}\ngetServerData();\n\n///PINTAR SERIES\\\\\\\n\nfunction paintSeries() {\n  let htmlCode = \"\";\n  for (let i = 0; i < series.length; i++) {\n    const favoriteIndex = favoritesSeries.findIndex(function(item, index) {\n      return item.id === series[i].show.id;\n    });\n    const isFavorite = favoriteIndex !== -1;\n\n    console.log(\"fav\", favoritesSeries, \"actual id\", i);\n\n    if (isFavorite === true) {\n      htmlCode += `<li class=\"js-serie-element serie__element--fav\" id=\"${series[i].show.id}\">`;\n    } else {\n      htmlCode += `<li class=\"js-serie-element serie__element\" id=\"${series[i].show.id}\">`;\n    }\n\n    if (series[i].show.image !== null) {\n      htmlCode += `<img src=\"${series[i].show.image.medium}\" class=\"js-serie-image serie__image\"/>`;\n    } else {\n      htmlCode += `<img src=\"https://via.placeholder.com/210x295/ffffff/666666/?\n        text=TV.\" class=\"js-serie-image serie__image\"/>`;\n    }\n\n    htmlCode += `<h3 class=\"js-serie-title serie__title\">${series[i].show.name}</h3>`;\n    htmlCode += `</li>`;\n  }\n  seriesList.innerHTML = htmlCode;\n}\n\n///ESCUCHAR SERIES\\\\\\\n\nfunction toggleFavorites(event) {\n  const clickedId = parseInt(event.currentTarget.id);\n  const clickedIndex = favoritesSeries.findIndex(function(item, index) {\n    return item.id === clickedId;\n  });\n  const isFavorite = clickedIndex !== -1;\n  if (isFavorite === true) {\n    favoritesSeries.splice(clickedIndex, 1);\n    // console.log(\"es favorito? y lo saco\");\n  } else {\n    for (let i = 0; i < series.length; i++) {\n      if (series[i].show.id === clickedId) {\n        favoritesSeries.push(series[i].show);\n        // console.log(\"No es favorito y lo meto\");\n      }\n    }\n  }\n\n  console.log(event.currentTarget.id, favoritesSeries);\n  console.log(clickedIndex);\n  console.log(isFavorite);\n  paintSeries();\n  listenSeries();\n  paintFavoritesSeries();\n  setLocalStorage();\n  listenDelete();\n}\n\n///ESCUCHADOR SERIES\\\\\\\nfunction listenSeries() {\n  const serieElements = document.querySelectorAll(\".js-serie-element\");\n\n  for (const serieElement of serieElements) {\n    serieElement.addEventListener(\"click\", toggleFavorites);\n  }\n}\n\n///ESCUCHEDOR BOTON\\\\\\\n\nfunction listenDelete() {\n  const deleteElements = document.querySelectorAll(\".js-delete\");\n  for (const deleteElement of deleteElements) {\n    deleteElement.addEventListener(\"click\", toggleFavorites);\n  }\n  console.log(\"me oyo\");\n}\n\n///PINTAR SERIES FAVORITAS\\\\\\\n\nfunction paintFavoritesSeries() {\n  let htmlCode = \"\";\n  htmlCode += `<li><h3>Mis series favoritas:</h3></li>`;\n\n  for (const favoritesSerie of favoritesSeries) {\n    htmlCode += `<li class=\"serie__element\" id=\"${favoritesSerie.id}\">`;\n    htmlCode += `<img src=\"${favoritesSerie.image.medium}\" class=\"js-serie-image serie__image\"/>`;\n    htmlCode += `<h3 class=\"js-serie-title serie__title\">${favoritesSerie.name} <span class=\"js-delete delete-button\" id=\"${favoritesSerie.id}\">x</span></h3>`;\n    htmlCode += `</li>`;\n  }\n  seriesListFav.innerHTML = htmlCode;\n  listenDelete();\n}\n\n// const buttonLog = document.querySelector(\".js-button-log\");\n\n// function logNames(event) {\n//   event.preventDefault();\n//   for (let i = 0; i < series.length; i++) {\n//     console.log(series[i].show.name);\n//   }\n// }\n\n// buttonLog.addEventListener(\"click\", logNames);\n\n///FUNCTION MATHERFUCKER\\\\\\\n\nfunction handleFormSubmit(event) {\n  event.preventDefault();\n  getServerData();\n  getLocalStorage();\n  paintSeries();\n  toggleFavorites(event);\n  listenSeries();\n  paintFavoritesSeries();\n}\n\nsearchBtn.addEventListener(\"click\", handleFormSubmit);\n\ngetLocalStorage();\n"]}